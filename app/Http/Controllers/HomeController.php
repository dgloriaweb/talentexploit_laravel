<?php

namespace App\Http\Controllers;

use App\Services\PersonService;
use App\Services\RateService;

class HomeController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        $data = [
            'title' => 'Home'
        ];


        //get jobs from database, get calculated match rate and add here
        //return: job name, job id, job rate
        //add jobs to $data
        $data['all_job_match_rates'] = RateService::getAllJobMatchRates();
        //check if user is logged in
        if (!session()->exists('person_id')) {
            return view('logged_out_home',  $data);
        }

        return view('logged_in_home',  $data);
    }

    public function demo()
    {
        $data = [
            'title' => 'Demo'
        ];
        return view('demo',  $data);
    }

    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function dummyjob()
    {
        //user dummy ID is mine
        $person_id = 4;
        //user dummy job is 7
        $job_id = 7;
        $drivers_license_rate = RateService::get_drivers_rate($person_id, $job_id);
        $workprefs_rate = RateService::getWorkPrefRate($person_id, $job_id);
        $workprefs_array = PersonService::getWorkprefsById($person_id);
        // echo '<pre>'; var_dump($workprefs_array); echo '</pre>'; die;
        $data = [
            'title' => 'Dummyjob',
            'modaltitle' => 'edit work day, time and location preferences',
            'modaltext' => 'select or deselect preferred options.',
            'drivers_license_rate' => $drivers_license_rate,
            'workprefs_rate' => $workprefs_rate,
            'workprefs_array' => $workprefs_array
        ];
        // add workprefs here
        $data = array_merge($data);

        return view('dummyjob', $data);
    }

    public function job_insight($id = null)
    {
        //user dummy ID is mine
        $person_id = 4;
        //user dummy job is 7
        $job_id = 7;
        $drivers_license_rate = RateService::get_drivers_rate($person_id, $job_id);
        $workprefs_rate = RateService::getWorkPrefRate($person_id, $job_id);
        $workprefs_array = PersonService::getWorkprefsById($person_id);
        // echo '<pre>'; var_dump($workprefs_array); echo '</pre>'; die;
        $data = [
            'title' => 'Job Insight',
            'modaltitle' => 'edit work day, time and location preferences',
            'modaltext' => 'select or deselect preferred options.',
            'drivers_license_rate' => $drivers_license_rate,
            'workprefs_rate' => $workprefs_rate,
            'workprefs_array' => $workprefs_array
        ];
        // add workprefs here
        $data = array_merge($data);

        return view('job_insight', $data);
    }
}
